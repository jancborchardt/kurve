!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/js",t(t.s=19)}([function(e,t,n){"use strict";function r(e){return"object"===x(e)}function i(e){return"number"===x(e)}function o(e){return i(e)&&e>0}function a(e){return i(e)&&e%1==0}function s(e){return a(e)&&e>0}function u(e){return"string"===x(e)}function l(e){return u(e)&&e.length>0}function c(e){return e.every(o)}function f(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}function d(e,t){return Math.abs(e)===Math.abs(t)}function h(e,t){return Math.random()*(t-e)+e}function y(e){var t=Math.PI,n=e%(2*t);return n=(n+2*t)%(2*t),n>t&&(n-=2*t),n}function p(e){return 180/Math.PI*e}function _(e,t){return e/t*1e3}function g(e){console.log(A+e)}function v(e){console.warn(A+e)}function m(e){console.error(A+e)}function b(e){return document.getElementById(e)}function w(e){return e instanceof HTMLElement}function k(e){if(!w(e))throw new TypeError(e+" is not a DOM node.");e.textContent=""}function P(e,t,n,r,i,o){for(var a=e;a<t;a++)for(var s=n;s<r;s++)i.call(this,s,a,o)}function E(e){return Array.isArray(e)&&e.some(R.isDown,R)}function S(e){return Array.isArray(e)&&e.map(D.unpack).some(H.isDown,H)}function O(e){return E(e)||S(e)}function M(e){return s(e)&&Object.keys(D).some(function(e){return D.hasOwnProperty(e)})}function T(e){return Array.isArray(e)&&e.length>0&&e.every(s)}function C(e){return L.includes(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.isObject=r,t.isNumber=i,t.isPositiveNumber=o,t.isInt=a,t.isPositiveInt=s,t.isString=u,t.isNonEmptyString=l,t.arePositiveNumbers=c,t.round=f,t.sameAbs=d,t.randomFloat=h,t.normalizeAngle=y,t.radToDeg=p,t.distanceToDuration=_,t.log=g,t.logWarning=v,t.logError=m,t.byID=b,t.isHTMLElement=w,t.flush=k,t.forfor=P,t.anyKeyBeingPressed=E,t.anyMouseButtonBeingPressed=S,t.anyInputBeingPressed=O,t.isMouseButton=M,t.isKeyList=T,t.isFKey=C;var x=function(e){return function(t){return t===e?"global":{}.toString.call(t).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()}}(void 0),A="[Zatacka] ",I=t.KEY=Object.freeze({BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,LEFT_META:91,RIGHT_META:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUM_LOCK:144,SCROLL_LOCK:145,SEMICOLON:186,EQUALS:187,COMMA:188,DASH:189,PERIOD:190,FORWARD_SLASH:191,GRAVE_ACCENT:192,OPEN_BRACKET:219,BACK_SLASH:220,CLOSE_BRACKET:221,SINGLE_QUOTE:222}),D=t.MOUSE=Object.freeze(function(){return Object.freeze({unpack:function(e){return e-1e3},pack:function(e){return e+1e3},LEFT:1e3,RIGHT:1002,MIDDLE:1001,MOUSE4:1003,MOUSE5:1004})}()),L=t.F_KEYS=Object.freeze([I.F1,I.F2,I.F3,I.F4,I.F5,I.F6,I.F7,I.F8,I.F9,I.F10,I.F11,I.F12]),R=(t.MOUSE_BUTTONS=Object.freeze([D.LEFT,D.RIGHT,D.MIDDLE,D.MOUSE4,D.MOUSE5]),t.Keyboard={pressed:{},isDown:function(e){return!!this.pressed[e]},onKeydown:function(e){this.pressed[e.keyCode]=!0},onKeyup:function(e){delete this.pressed[e.keyCode]},reset:function(){this.pressed={}}}),H=t.Mouse={pressed:{},isDown:function(e){return this.pressed[e]},onMousedown:function(e){this.pressed[e.button]=!0},onMouseup:function(e){delete this.pressed[e.button]},reset:function(){this.pressed={}}},F=t.PLATFORM=function(){var e={os_id_windows:"Win",os_id_mac:"Mac",os_id_linux:"Linux",os_id_unix:"X11",os_name_windows:"Windows",os_name_mac:"Mac",os_name_linux:"Linux",os_name_unix:"UNIX",os_name_unknown:"Unknown"};return{getOS:function(){var t=window.navigator.userAgent||window.navigator.appVersion;if(l(t)){if(t.indexOf(e.os_id_windows)>-1)return e.os_name_windows;if(t.indexOf(e.os_id_mac)>-1)return e.os_name_mac;if(t.indexOf(e.os_id_linux)>-1)return e.os_name_linux;if(t.indexOf(e.os_id_unix)>-1)return e.os_name_unix}return e.os_name_unknown},getFullscreenShortcut:function(){switch(F.getOS()){case e.os_name_mac:return"mac";default:return"default"}}}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return Object.freeze({hint_unload:"Are you sure you want to unload the page?",hint_start:"Press <kbd>Space</kbd> to start",hint_popup:'It is recommended to run Kurve in its own window without history (to avoid switching tabs or navigating back in history mid-game). To do that, please allow popups or <a href="ZATACKA.html" target="_blank">click here</a>.',hint_pick:"Pick your desired color by pressing the corresponding LEFT key (e.g. M for Orange).",hint_proceed:"Press Space or Enter to start!",hint_next:"Press Space or Enter to proceed, or Esc to quit.",hint_quit:"Press Space or Enter to start over.",hint_alt:"Alt plus some other keys may cause undesired behavior (e.g. switching windows).",hint_ctrl:"Ctrl plus some other keys may cause undesired behavior (e.g. closing the tab).",hint_mouse:"Make sure to keep the mouse cursor inside the browser window.",hint_preferences_access_denied:'Could not save/load settings because access to localStorage was denied by the browser. This might be caused by "third-party site data" being blocked or similar.',hint_preferences_localstorage_failed:"Could not save/load settings because access to localStorage failed.",keyboard_fullscreen_mac:"<kbd>⌘ + Ctrl + F</kbd> and/or <kbd>⌘ + ⇧ + F</kbd>",keyboard_fullscreen_standard:"<kbd>F11</kbd>",getFullscreenHint:function(e){return"Press "+e+" to toggle fullscreen"},label_button_alert_ok:"OK",label_button_confirm_yes:"Yes",label_button_confirm_no:"No",label_text_confirm_quit:"Are you sure you want to quit?",label_text_confirm_reload:"Are you sure you want to reload the application?",pref_label_cursor:"Mouse pointer",pref_label_description_cursor:'Control how the pointer behaves when the game is live. (It is always visible in the menu.) "Used by player" means that a player is using the mouse to control their Kurve.',pref_label_cursor_always_visible:"Always visible",pref_label_cursor_hidden_when_mouse_used_by_player:"Hidden when mouse used by player",pref_label_cursor_always_hidden:"Always hidden",pref_label_edge_fix:"Invisible border fix",pref_label_description_edge_fix:"Shrink the playing field slightly to make the gray border visible if the monitor is exactly the same height and/or width as the game (in pixels).",pref_label_edge_fix_off:"Off",pref_label_edge_fix_minimal:"Minimal",pref_label_edge_fix_full:"Full",pref_label_hints:"Messages",pref_label_description_hints:"Hints (white text) are unnecessary for experienced Kurve players. Warnings (yellow) can be useful for players new to playing Kurve in the browser.",pref_label_hints_all:"Hints and warnings",pref_label_hints_warnings_only:"Warnings only",pref_label_hints_none:"None",pref_label_prevent_spawnkill:"Prevent spawnkills",pref_label_description_prevent_spawnkill:"Enforce a minimum distance between players at round start.",pref_label_confirm_quit:"Confirm quit",pref_label_description_confirm_quit:"Ask for confirmation before quitting to the main menu (Esc) or reloading the application (F5).",pref_label_scaling:"Scaling",pref_label_description_scaling:"Visual quality ensures a crisp, pixelmapped image. On-screen size may result in blurry graphics and other visual errors, but can be useful if the game is very small on your screen.",pref_label_scaling_prefer_quality:"Prefer visual quality",pref_label_scaling_prefer_size:"Prefer on-screen size"})}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=Object.freeze({game_url:"ZATACKA.html",error_name_security:"SecurityError",class_hidden:"hidden",class_active:"active",class_dialog:"dialog",class_dialog_alert:"alert",class_dialog_confirmation:"confirmation",class_description:"description",class_half_width:"half-width",class_right_hand_side:"right-hand-side",class_blurry:"blurry",class_nocursor:"nocursor",class_tempcursor:"tempcursor",class_hints_warnings_only:"hints-warnings-only",class_hints_none:"hints-none",html_name_preference_prefix:"preference-",cursor_hidden:"hidden",cursor_visible:"visible",id_start_hint:"start-hint",id_fullscreen_hint:"fullscreen-hint",id_popup_hint:"popup-hint",id_button_show_settings:"button-show-settings",id_button_hide_settings:"button-hide-settings",pref_number_type_integer:"integer",pref_number_type_float:"float",pref_key_cursor:"cursor",pref_value_cursor_always_visible:"always_visible",pref_value_cursor_hidden_when_mouse_used_by_player:"hidden_when_mouse_used_by_player",pref_value_cursor_always_hidden:"always_hidden",pref_key_edge_fix:"edge_fix",pref_value_edge_fix_full:"full",pref_value_edge_fix_minimal:"minimal",pref_value_edge_fix_off:"off",pref_key_hints:"hints",pref_value_hints_all:"all",pref_value_hints_warnings_only:"warnings",pref_value_hints_none:"none",pref_key_confirm_quit:"confirm_quit",pref_key_confirm_reload:"confirm_reload",pref_key_prevent_spawnkill:"prevent_spawnkill",pref_key_scaling:"scaling",pref_value_scaling_prefer_quality:"prefer_quality",pref_value_scaling_prefer_size:"prefer_size"})},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Preference=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(4);t.Preference=function(){function e(t){if(r(this,e),!(0,o.isString)(t.key))throw new TypeError("key must be a string (found "+t.key+"). More info: "+t);if(void 0===t.default)throw new TypeError("Preference '"+t.key+"' must have a default value.");if(void 0===t.label)throw new TypeError("Preference '"+t.key+"' must have a label.");if(void 0===t.description)throw new TypeError("Preference '"+t.key+"' must have a description.");this.key=t.key,this.label=t.label,this.default=t.default,this.description=t.description}return i(e,[{key:"isValidValue",value:function(e){return(0,o.isString)(e)}},{key:"invalidValue",value:function(e){throw new TypeError(e+" is not a valid value for preference '"+this.key+"'.")}},{key:"getDefaultValue",value:function(){return this.default}}],[{key:"stringify",value:function(e){return e.toString()}},{key:"parse",value:function(e){return e}}]),e}()},function(e,t,n){"use strict";function r(e){console.log(_+e)}function i(e){console.warn(_+e)}function o(e){console.error(_+e)}function a(e){return"object"===p(e)}function s(e){return"number"===p(e)}function u(e){return s(e)&&e>0}function l(e){return s(e)&&e%1==0}function c(e){return l(e)&&e>0}function f(e){return"string"===p(e)}function d(e){return f(e)&&e.length>0}function h(e){return e.every(u)}function y(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.log=r,t.logWarning=i,t.logError=o,t.isObject=a,t.isNumber=s,t.isPositiveNumber=u,t.isInt=l,t.isPositiveInt=c,t.isString=f,t.isNonEmptyString=d,t.arePositiveNumbers=h,t.round=y;var p=function(e){return function(t){return t===e?"global":{}.toString.call(t).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()}}(void 0),_="[Preferences] "},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=n(22);t.Player=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Player "+t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"white",s=arguments[3],u=arguments[4],l=arguments[5];if(r(this,e),!(0,o.isPositiveInt)(t))throw new TypeError("Cannot create a player with ID "+t+". Only positive integers are accepted.");this.id=t,this.name=n,this.color=i,this.alive=!1,this.holy=!1,this.x=null,this.y=null,this.direction=0,this.velocity=0,this.maxSpeed=void 0,this.lastPosition=null,this.queuedDraws=new a.Queue,this.holeTimer=null,this.holeConfig=null,this.constructor.isHoleConfig(l)?this.holeConfig=l:(0,o.logWarning)("Creating player "+this.name+" with no hole configuration because "+l+" is not a valid hole configuration."),(0,o.isPositiveInt)(s)?this.L_keys=[s]:(0,o.isKeyList)(s)?this.L_keys=s:((0,o.logWarning)('Creating player "'+this.name+'" without any LEFT key(s).'),this.L_keys=[]),(0,o.isPositiveInt)(u)?this.R_keys=[u]:(0,o.isKeyList)(u)?this.R_keys=u:((0,o.logWarning)('Creating player "'+this.name+'" without any RIGHT key(s).'),this.R_keys=[])}return i(e,[{key:"isAlive",value:function(){return this.alive}},{key:"justWasAt",value:function(e,t){return this.lastPosition.left===e&&this.lastPosition.top===t}},{key:"isHoly",value:function(){return this.holy}},{key:"isPressingLeft",value:function(){return(0,o.anyInputBeingPressed)(this.L_keys)}},{key:"isPressingRight",value:function(){return(0,o.anyInputBeingPressed)(this.R_keys)}},{key:"hasID",value:function(e){return this.id===e}},{key:"hasMouseButton",value:function(e){return(0,o.isMouseButton)(e)&&(this.L_keys.includes(e)||this.R_keys.includes(e))}},{key:"usesAnyMouseButton",value:function(){var e=this;return o.MOUSE_BUTTONS.some(function(t){return e.hasMouseButton(t)})}},{key:"hasKey",value:function(e){return this.L_keys.includes(e)||this.R_keys.includes(e)}},{key:"getID",value:function(){return this.id}},{key:"getName",value:function(){return this.name}},{key:"getColor",value:function(){return this.color}},{key:"toString",value:function(){return this.name}},{key:"getLastPosition",value:function(){return this.lastPosition}},{key:"getVelocity",value:function(){return this.velocity}},{key:"getDirection",value:function(){return this.direction}},{key:"randomPaddedHoleSize",value:function(){return(0,o.randomFloat)(this.holeConfig.minPaddedHoleSize,this.holeConfig.maxPaddedHoleSize)}},{key:"randomPaddedHoleInterval",value:function(){return(0,o.randomFloat)(this.holeConfig.minPaddedHoleInterval,this.holeConfig.maxPaddedHoleInterval)}},{key:"firstHoleDelay",value:function(){return(0,o.distanceToDuration)(this.randomPaddedHoleInterval()-this.holeConfig.minPaddedHoleInterval,this.velocity)}},{key:"setMaxSpeed",value:function(e){this.maxSpeed=e}},{key:"setDirection",value:function(e){this.direction=e}},{key:"start",value:function(){(0,o.log)(this+" starting."),this.alive=!0,this.velocity=this.maxSpeed,this.constructor.isHoleConfig(this.holeConfig)&&(this.holeTimer=setTimeout(this.startCreatingHoles.bind(this),this.firstHoleDelay()))}},{key:"stop",value:function(){this.alive=!1,this.velocity=0,clearTimeout(this.holeTimer)}},{key:"reset",value:function(){this.holy=!1,this.lastPosition=null,this.queuedDraws=new a.Queue}},{key:"die",value:function(e){this.alive=!1,clearTimeout(this.holeTimer),(0,o.log)(this+" "+(e||"died")+" at ("+(0,o.round)(this.x,2)+", "+(0,o.round)(this.y,2)+").")}},{key:"beAt",value:function(e,t){this.lastPosition={left:e,top:t}}},{key:"beginHole",value:function(){this.holy=!0;var e=this.randomPaddedHoleSize(),t=(0,o.distanceToDuration)(e,this.velocity);this.holeTimer=setTimeout(this.endHole.bind(this),t)}},{key:"endHole",value:function(){this.holy=!1;var e=this.randomPaddedHoleInterval(),t=(0,o.distanceToDuration)(e,this.velocity);this.holeTimer=setTimeout(this.beginHole.bind(this),t)}},{key:"startCreatingHoles",value:function(){this.beginHole()}},{key:"enqueueDraw",value:function(){this.queuedDraws.enqueue({x:this.x,y:this.y})}}],[{key:"isPlayer",value:function(t){return t instanceof e}},{key:"isHoleConfig",value:function(e){return(0,o.isObject)(e)&&(0,o.arePositiveNumbers)([e.minPaddedHoleSize,e.maxPaddedHoleSize,e.minPaddedHoleInterval,e.maxPaddedHoleInterval])}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ConfirmationDialog=void 0;var a=n(7);t.ConfirmationDialog=function(e){function t(e,n){if(r(this,t),!(n instanceof Function))throw new TypeError("callback must be a function (found "+n+").");var o=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.callback=n,o}return o(t,e),t}(a.Dialog)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Dialog=void 0;var i=n(0);t.Dialog=function e(t){if(r(this,e),!(0,i.isString)(t))throw new TypeError("text must be a string (found "+t+").");this.text=t}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.Message=function(){function e(t,n){r(this,e),this.text=t,this.class=n}return i(e,[{key:"toHTMLElement",value:function(){var e=document.createElement("p");return e.textContent=this.text,e.classList.add(this.class),e.classList.add("message"),e}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BooleanPreference=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=n(3);t.BooleanPreference=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return!0!==e.default&&!1!==e.default&&s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"invalidValue",n).call(n,e.default),n}return o(t,e),a(t,[{key:"isValidValue",value:function(e){return!0===e||!1===e}}],[{key:"stringify",value:function(e){return e.toString()}},{key:"parse",value:function(e){return"true"===e}}]),t}(u.Preference)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MultichoicePreference=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=n(3),l=n(25);t.MultichoicePreference=function(e){function t(e){if(r(this,t),!function(e){return e instanceof Array}(e.options))throw new TypeError("options must be an array (found "+e.options+" for preference '"+e.key+"').");if(!function(e){return e.length>1}(e.options))throw new TypeError("options must have a length greater than 1 (was "+e.options.length+" for preference '"+e.key+"').");var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));try{n.options=e.options.map(function(e){return new l.MultichoicePreferenceOption(e.key,e.label)})}catch(t){throw new TypeError("The list of options for preference '"+e.key+"' was malformed: "+t.message)}return n.isValidValue(e.default)||s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"invalidValue",n).call(n,e.default),n}return o(t,e),a(t,[{key:"isValidValue",value:function(e){return this.options.some(function(t){return t.key===e})}}],[{key:"stringify",value:function(e){return e}},{key:"parse",value:function(e){return e}}]),t}(u.Preference)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RangePreference=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=n(3),l=n(4);t.RangePreference=function(e){function t(e){if(r(this,t),!(0,l.isNumber)(e.min)||!(0,l.isNumber)(e.max))throw new TypeError("min and max must be numbers (found "+e.min+" and "+e.max+" for preference '"+e.key+"').");if(e.min>e.max)throw new TypeError("min cannot be greater than max (found "+e.min+" and "+e.max+" for preference '"+e.key+"', respectively).");var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.min=e.min,n.max=e.max,n.isValidValue(e.default)||s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"invalidValue",n).call(n,e.default),n}return o(t,e),a(t,[{key:"isValidValue",value:function(e){return(0,l.isNumber)(e)&&e>=this.min&&e<=this.max}}],[{key:"stringify",value:function(e){return e.toString()}},{key:"parse",value:function(e){return parseFloat(e)}}]),t}(u.Preference)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){function t(){(0,h.log)("Hiding lobby."),oe.classList.add(g.default.class_hidden)}function n(){(0,h.log)("Showing lobby."),oe.classList.remove(g.default.class_hidden)}function r(){de.classList.remove(g.default.class_hidden)}function o(){de.classList.add(g.default.class_hidden)}function y(e){return(0,h.isHTMLElement)(e)&&e.children.length>=2}function _(e){return e instanceof ve}function v(e){var t=S(e);Se=new Oe(e,t),x(!0),r(),de.appendChild(t),t.querySelector("button:last-of-type").focus()}function m(){Se.box.remove(),Se=null,b()?v(Ee.shift()):(x(!1),o())}function b(){return Ee.length>0}function w(){return Se.dialog instanceof d.ConfirmationDialog}function k(e){var t=document.createElement("div");t.classList.add(g.default.class_dialog);var n=document.createElement("p");return n.textContent=e,t.appendChild(n),t}function P(e){function t(){m()}var n=k(e.text);n.classList.add(g.default.class_dialog_alert);var r=document.createElement("button");return r.textContent=me,n.appendChild(r),r.addEventListener("click",t),n}function E(e){function t(t){return function(){m(),!0===t&&e.callback()}}var n=k(e.text);n.classList.add(g.default.class_dialog_confirmation);var r=document.createElement("button");r.textContent=be;var i=document.createElement("button");return i.textContent=we,n.appendChild(r),n.appendChild(i),r.addEventListener("click",t(!0)),i.addEventListener("click",t(!1)),n}function S(e){if(e instanceof d.ConfirmationDialog)return E(e);if(e instanceof f.Dialog)return P(e);throw new TypeError(e+" is not a valid dialog.")}function O(e){e.classList.remove("active")}function M(){Array.from(ue.children).forEach(O)}function T(){Array.from(le.children).forEach(O)}function C(e){switch(e){case g.default.cursor_visible:document.body.classList.remove(g.default.class_nocursor);break;case g.default.cursor_hidden:document.body.classList.add(g.default.class_nocursor);break;default:(0,h.logError)("Cannot set cursor behavior to '"+e+"'.")}}function x(e){e?document.body.classList.add(g.default.class_tempcursor):document.body.classList.remove(g.default.class_tempcursor)}function A(e){if(e instanceof c.MultichoicePreference){return e.options.map(function(e){return e.label}).reduce(function(e,t){return t.length>e.length?t:e}).length<=pe}return!1}function I(e,t){if(!(e instanceof a.Preference))throw new TypeError(e+" is not a preference.");var n=document.createElement("div"),r=document.createElement("label");r.textContent=e.label,r.setAttribute("for",""+g.default.html_name_preference_prefix+e.key);var i=document.createElement("aside");if(i.textContent=e.description,i.classList.add(g.default.class_description),e instanceof s.BooleanPreference){var o=document.createElement("input");o.type="checkbox",o.dataset.key=e.key,o.id=g.default.html_name_preference_prefix+e.key,o.checked=!0===t,n.appendChild(o),n.appendChild(r)}else if(e instanceof c.MultichoicePreference){var f=document.createElement("fieldset"),d=document.createElement("legend");d.textContent=e.label,f.appendChild(d),e.options.forEach(function(n){var r=g.default.html_name_preference_prefix+e.key+"-"+n.key,i=document.createElement("input");i.type="radio",i.id=r,i.name=g.default.html_name_preference_prefix+e.key,i.value=n.key,i.dataset.key=e.key,i.checked=t===n.key;var o=document.createElement("label");o.textContent=n.label,o.setAttribute("for",r),f.appendChild(i),f.appendChild(o)}),n.appendChild(f),A(e)&&n.classList.add(g.default.class_half_width)}else if(e instanceof u.RangePreference){var h=e instanceof l.IntegerRangePreference;n.appendChild(r);var y=document.createElement("input");y.type="number",y.dataset.key=e.key,y.dataset.numberType=h?g.default.pref_number_type_integer:g.default.pref_number_type_float,y.name=g.default.html_name_preference_prefix+e.key,y.setAttribute("step",h?1:_e),y.setAttribute("min",e.min),y.setAttribute("max",e.max),y.value=t,n.appendChild(y)}return n.appendChild(i),n}function D(e,t){if(H()){var n=Se.box.querySelector(ge+":focus"),r=h.Keyboard.isDown(h.KEY.SHIFT),i=void 0,o=void 0;switch(_(n)&&(i=_(n.previousSibling)?n.previousSibling:null,o=_(n.nextSibling)?n.nextSibling:null),e.keyCode){case h.KEY.SPACE:case h.KEY.ENTER:_(n)&&n.click();break;case h.KEY.ESCAPE:w()&&m();break;case h.KEY.TAB:e.preventDefault(),r?_(i)&&i.focus():_(o)&&o.focus();break;case h.KEY.LEFT_ARROW:_(i)&&i.focus();break;case h.KEY.RIGHT_ARROW:_(o)&&o.focus();break;default:t(e)}}else t(e)}function L(e,t){H()||t(e)}function R(e){H()?Ee.push(e):v(e)}function H(){return null!==Se}function F(e){se.style.width=ye+e+"px"}function j(e){document.body.classList[!0===e?"add":"remove"](g.default.class_blurry)}function U(e){var t=e-1,n=ae.children[t];y(n)?n.children[1].classList.add(g.default.class_active):(0,h.logWarning)("Cannot mark player "+e+" as ready because controls.children["+t+"] ("+ae.children[t]+") is not a valid lobby entry.")}function q(e){var t=e-1,n=ae.children[t];y(n)?n.children[1].classList.remove(g.default.class_active):(0,h.logWarning)("Cannot mark player "+e+" as unready because controls.children["+t+"] ("+ae.children[t]+") is not a valid lobby entry.")}function K(){for(var e=1;e<=ae.children.length;e++)q(e)}function N(){t()}function W(){Y(),n(),te(),M(),T(),K(),C(g.default.cursor_visible)}function V(){G(),M()}function G(){ce.classList.remove(g.default.class_hidden)}function Y(){ce.classList.add(g.default.class_hidden)}function z(e){Pe.includes(e)||Pe.push(e),ee(Pe)}function B(){ke=!0,settings.classList.remove(g.default.class_hidden)}function Q(){ke=!1,settings.classList.add(g.default.class_hidden)}function X(){return ke}function Z(e){(0,h.flush)(he);for(var t=e.map(function(e){return I(e.preference,e.value)}),n=0,r=0;r<t.length;r++){var i=t[r];i.classList.contains(g.default.class_half_width)?++n%2==0&&i.classList.add(g.default.class_right_hand_side):n=0}t.forEach(function(e){he.appendChild(e)})}function J(){var e=[],t=he.querySelectorAll("input");Array.from(t).forEach(function(t){"checkbox"===t.type?e.push({key:t.dataset.key,value:t.checked}):"radio"===t.type?!0===t.checked&&e.push({key:t.dataset.key,value:t.value}):"number"===t.type?e.push({key:t.dataset.key,value:(t.dataset.numberType===g.default.pref_number_type_integer?parseInt:parseFloat)(t.value)}):e.push({key:t.dataset.key,value:t.value.toString()})});var n=he.querySelectorAll("select");return Array.from(n).forEach(function(t){e.push({key:t.dataset.key,value:t.options[t.selectedIndex].value})}),e}function $(e){Pe=Pe.filter(function(t){return t!==e}),ee(Pe)}function ee(e){(0,h.isHTMLElement)(fe)?((0,h.flush)(fe),e.forEach(function(e){fe.insertBefore(e.toHTMLElement(),null)})):(0,h.logWarning)("Cannot update messages because "+fe+" is not an HTML element.")}function te(){Pe=[],ee(Pe)}function ne(e){switch((0,h.log)("Setting message mode to "+e+"."),e){case g.default.pref_value_hints_warnings_only:fe.classList.remove(g.default.class_hints_none),fe.classList.add(g.default.class_hints_warnings_only);break;case g.default.pref_value_hints_none:fe.classList.remove(g.default.class_hints_warnings_only),fe.classList.add(g.default.class_hints_none);break;default:fe.classList.remove(g.default.class_hints_warnings_only),fe.classList.remove(g.default.class_hints_none)}}function re(e,t,n){if((0,h.isHTMLElement)(e)){var r=e.children[t-1];if((0,h.isHTMLElement)(r)){var i=function(e){return"d"+e},o=function(){return document.createElement("div")},a=n.toString().split("").map(i);(0,h.flush)(r),r.classList.add("active"),a.forEach(function(e,t){var n=o();n.classList.add(a[t]),r.appendChild(n)})}else(0,h.logWarning)("Cannot update score of player "+t+" because "+r+" is not an HTML element.")}else(0,h.logWarning)("Cannot update any entry in "+e+" because it is not an HTML element.")}function ie(e,t){re(ue,e,t),re(le,e,t)}var oe=(0,h.byID)("lobby"),ae=(0,h.byID)("controls"),se=((0,h.byID)("canvas_main"),(0,h.byID)("canvas_overlay"),(0,h.byID)("left")),ue=(0,h.byID)("scoreboard"),le=(0,h.byID)("results"),ce=(0,h.byID)("KONEC_HRY"),fe=(0,h.byID)("messages"),de=(0,h.byID)("dialogs"),he=(0,h.byID)("settings-form"),ye=se.offsetWidth,pe=20,_e=.01,ge="button",ve=HTMLButtonElement,me=p.default.label_button_alert_ok,be=p.default.label_button_confirm_yes,we=p.default.label_button_confirm_no,ke=!1,Pe=[],Ee=[],Se=null,Oe=function e(t,n){i(this,e),this.dialog=t,this.box=n};return{keyPressed:D,mouseClicked:L,playerReady:U,playerUnready:q,gameStarted:N,gameQuit:W,konecHry:V,showDialog:R,isShowingDialog:H,showSettings:B,hideSettings:Q,isShowingSettings:X,updateSettingsForm:Z,parseSettingsForm:J,updateScoreOfPlayer:ie,updateMessages:ee,showMessage:z,hideMessage:$,clearMessages:te,setMessageMode:ne,setCursorBehavior:C,setBlurryScaling:j,setEdgePadding:F}}Object.defineProperty(t,"__esModule",{value:!0}),t.GUIController=o;var a=n(3),s=n(9),u=n(11),l=n(24),c=n(10),f=n(7),d=n(6),h=n(0),y=n(1),p=r(y),_=n(2),g=r(_)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(23),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=n(5),u=n(20),l=n(0);t.Game=function(){function e(t,n,i){if(r(this,e),this.constructor.PRACTICE="practice",this.constructor.COMPETITIVE="competitive",this.constructor.DEFAULT_MODE=this.constructor.PRACTICE,this.constructor.DEFAULT_TARGET_SCORE=10,this.constructor.MAX_TARGET_SCORE=1e3,this.constructor.MAX_PLAYERS=255,this.constructor.MAX_QUOTA_THAT_SPAWN_CIRCLES_MAY_FILL=.5,this.constructor.DESIRED_MINIMUM_SPAWN_DISTANCE_TURNING_RADIUS_FACTOR=1,this.constructor.KONEC_HRY="KONEC HRY!",void 0===n)throw new TypeError("Cannot create a Game with no renderer.");if(!this.constructor.isRenderer(n))throw new TypeError(n+" is not a valid renderer.");if(void 0===i)throw new TypeError("Cannot create a Game with no GUI controller.");if(!this.constructor.isGUIController(i))throw new TypeError(i+" is not a valid GUI controller.");this.config=t,this.width=t.canvas.width,this.height=t.canvas.height,this.pixels=null,this.players=[],this.rounds=[],this.renderer=n,this.guiController=i,this.mode=this.constructor.DEFAULT_MODE,this.preventSpawnkill=t.preventSpawnkill,this.totalNumberOfTicks=0,this.targetScore=null,this.initMainLoop(),this.started=!1,this.ended=!1,this.proceedHintTimer=null,this.quitHintTimer=null}return i(e,[{key:"edgeOfSquare",value:function(e){return Math.round(e-this.config.thickness/2)}},{key:"maxPlayers",value:function(){return this.constructor.MAX_PLAYERS}},{key:"maxTicksBetweenDraws",value:function(){return Math.max(Math.floor(this.config.tickrate/this.config.speed),1)}},{key:"computeAngleChange",value:function(){return this.config.speed/(this.config.tickrate*this.config.turningRadius)}},{key:"computeSpawnArea",value:function(){return{x_min:this.config.spawnMargin,y_min:this.config.spawnMargin,x_max:this.width-this.config.spawnMargin,y_max:this.height-this.config.spawnMargin}}},{key:"computeFrontCornerPixel",value:function(e,t){var n=this.config.thickness;return(100*e+100*(n-1)/2+100*t*(n-1)/2)/100}},{key:"computeFrontEdgePixel",value:function(e,t,n,r){var i=this.config.thickness;return e+Math.abs(t)*(i-1)/2+t*(i-1)/2+Math.abs(n)*r}},{key:"computeHitbox",value:function(e,t,n){var r=[],i=e.getLastPosition(),o=t-i.left,a=n-i.top;if((0,l.sameAbs)(o,a)){var s=this.computeFrontCornerPixel(t,o),u=this.computeFrontCornerPixel(n,a);r.push(this.pixelAddress(s,u))}else for(var c=0;c<this.config.thickness;c++){var f=this.computeFrontEdgePixel(t,o,a,c),d=this.computeFrontEdgePixel(n,a,o,c);r.push(this.pixelAddress(f,d))}return r}},{key:"desiredMinimumSpawnDistance",value:function(){var e=this.config.turningRadius*this.constructor.DESIRED_MINIMUM_SPAWN_DISTANCE_TURNING_RADIUS_FACTOR;return(0,l.round)(this.config.thickness+e,2)}},{key:"safeMinimumSpawnDistance",value:function(){var e=this.computeSpawnArea(),t=(e.x_max-e.x_min)*(e.y_max-e.y_min),n=Math.sqrt(this.constructor.MAX_QUOTA_THAT_SPAWN_CIRCLES_MAY_FILL*t/(this.getNumberOfPlayers()*Math.PI));return Math.min(this.desiredMinimumSpawnDistance(),(0,l.round)(n,2))}},{key:"isSafeSpawnPosition",value:function(e){for(var t=0;t<this.players.length;t++){var n={x:this.players[t].x,y:this.players[t].y};if(function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}(n,e)<this.safeMinimumSpawnDistance())return!1}return!0}},{key:"safeSpawnPosition",value:function(){var e=void 0;do{e=this.randomSpawnPosition()}while(!this.isSafeSpawnPosition(e));return e}},{key:"randomSpawnPosition",value:function(){var e=this.computeSpawnArea();return{x:(0,l.randomFloat)(e.x_min,e.x_max),y:(0,l.randomFloat)(e.y_min,e.y_max)}}},{key:"randomSpawnAngle",value:function(){return(0,l.randomFloat)(this.config.minSpawnAngle,this.config.maxSpawnAngle)}},{key:"pixelAddress",value:function(e,t){return t*this.width+e}},{key:"pixelAddressToCoordinates",value:function(e){var t=e%this.width;return"("+t+", "+(e-t)/this.width+")"}},{key:"getMode",value:function(){return this.mode}},{key:"getTargetScore",value:function(){return this.targetScore}},{key:"getPlayers",value:function(){return this.players}},{key:"getPlayerByID",value:function(e){return this.players.find(function(t){return t.hasID(e)})}},{key:"getLivePlayers",value:function(){var e=this.constructor.isAlive;return this.players.filter(e)}},{key:"getNumberOfPlayers",value:function(){return this.players.length}},{key:"getNumberOfLivePlayers",value:function(){return this.getLivePlayers().length}},{key:"getScoreOfPlayer",value:function(e){var t=function(t,n){return t+n.getSuccessOfPlayer(e)};return this.rounds.reduce(t,0)}},{key:"getCurrentRound",value:function(){return this.rounds[this.rounds.length-1]}},{key:"setMode",value:function(e){e===this.constructor.COMPETITIVE||e===this.constructor.PRACTICE?((0,l.log)("Setting game mode to "+e+"."),this.mode=e):(0,l.logError)(e+" is not a valid game mode. Keeping "+this.getMode()+".")}},{key:"setTargetScore",value:function(e){var t=this.constructor.DEFAULT_TARGET_SCORE,n=this.constructor.MAX_TARGET_SCORE;(0,l.isInt)(e)&&e>0?e>n?((0,l.logWarning)(e+" is larger than the maximum allowed target score of "+n+". Falling back to "+n+"."),t=n):((0,l.log)("Setting target score to "+e+"."),t=e):(0,l.logWarning)(e+" is not a valid target score. Defaulting to "+t+"."),this.targetScore=t}},{key:"setSize",value:function(e,t){this.width=e,this.height=t,this.renderer.setSize(e,t)}},{key:"setPreventSpawnkill",value:function(e){this.preventSpawnkill=e}},{key:"isStarted",value:function(){return this.started}},{key:"isEnded",value:function(){return this.ended}},{key:"isPostRound",value:function(){return this.getCurrentRound().getResults().length===this.getNumberOfPlayers()}},{key:"isLive",value:function(){return this.isCompetitive()?this.getNumberOfLivePlayers()>1:this.getNumberOfLivePlayers()>0}},{key:"isRoundOver",value:function(){return!this.isLive()}},{key:"isGameOver",value:function(){var e=this,t=function(t){return e.getScoreOfPlayer(t.getID())>=e.getTargetScore()};return!this.isLive()&&this.isCompetitive()&&this.players.some(t)}},{key:"isCompetitive",value:function(){return this.getMode()===this.constructor.COMPETITIVE}},{key:"isOccupiedPixelAddress",value:function(e){return this.pixels[e]>0}},{key:"isCrashing",value:function(e,t,n){return this.computeHitbox(e,t,n).some(this.isOccupiedPixelAddress,this)}},{key:"isOnField",value:function(e,t){return e>=0&&t>=0&&e+this.config.thickness<=this.width&&t+this.config.thickness<=this.height}},{key:"hasPlayer",value:function(e){return s.Player.isPlayer(this.getPlayerByID(e))}},{key:"addPlayer",value:function(e){var t=this.maxPlayers();if(!s.Player.isPlayer(e))throw new TypeError("Cannot add "+e+" to the game because it is not a player.");if(e.getID()>t)throw new RangeError("Cannot add "+e+" to the game because player IDs larger than "+t+" are not supported.");this.hasPlayer(e.getID())?(0,l.logWarning)("Not adding "+e+" to the game because there is already a player with ID "+e.getID()+"."):((0,l.log)(e+" ready!"),this.players.push(e),e.setMaxSpeed(this.config.speed),this.GUI_playerReady(e.getID()))}},{key:"removePlayer",value:function(e){var t=this.getPlayerByID(e);s.Player.isPlayer(t)&&((0,l.log)(t+" unready!"),this.GUI_playerUnready(e)),this.players=this.players.filter(function(e){return e!==t})}},{key:"start",value:function(){var e=this;this.isCompetitive()&&(this.setTargetScore(this.constructor.calculateTargetScore(this.getNumberOfPlayers())),this.players.forEach(function(t){e.GUI_updateScoreOfPlayer(t.getID(),0)})),(0,l.log)("Starting game!"),this.GUI_gameStarted(),a.default.start(),this.started=!0,this.pixels=new Uint8Array(this.width*this.height),this.beginNewRound()}},{key:"pause",value:function(){a.default.stop()}},{key:"isPaused",value:function(){return!a.default.isRunning()}},{key:"resume",value:function(){a.default.start()}},{key:"konecHry",value:function(){(0,l.log)(this.constructor.KONEC_HRY),this.ended=!0,this.GUI_konecHry(),this.quitHintTimer=setTimeout(this.showQuitHint.bind(this),this.config.hintDelay)}},{key:"quit",value:function(){clearTimeout(this.quitHintTimer),clearTimeout(this.proceedHintTimer)}},{key:"clearField",value:function(){this.pixels.fill(0),this.Render_clearField()}},{key:"showProceedHint",value:function(){this.GUI_showMessage(this.config.messages.next)}},{key:"hideProceedHint",value:function(){clearTimeout(this.proceedHintTimer),this.GUI_hideMessage(this.config.messages.next)}},{key:"showQuitHint",value:function(){this.GUI_showMessage(this.config.messages.quit)}},{key:"hideQuitHint",value:function(){clearTimeout(this.quitHintTimer),this.GUI_hideMessage(this.config.messages.quit)}},{key:"beginNewRound",value:function(){this.rounds.push(new u.Round),(0,l.log)("======== ROUND "+this.rounds.length+" ========"),this.resetPlayers(),this.clearField(),this.sortPlayers(),this.spawnAndStartPlayers()}},{key:"endRound",value:function(){this.stopPlayers(),this.proceedHintTimer=setTimeout(this.showProceedHint.bind(this),this.config.hintDelay)}},{key:"sortPlayers",value:function(){this.players.sort(function(e,t){return e.getID()-t.getID()})}},{key:"startPlayer",value:function(e){e.start()}},{key:"stopPlayer",value:function(e){e.stop()}},{key:"resetPlayer",value:function(e){e.reset()}},{key:"startPlayers",value:function(){this.players.forEach(this.startPlayer)}},{key:"stopPlayers",value:function(){this.players.forEach(this.stopPlayer)}},{key:"resetPlayers",value:function(){this.players.forEach(this.resetPlayer)}},{key:"occupyPixel",value:function(e,t,n){this.pixels[this.pixelAddress(e,t)]=n}},{key:"occupy",value:function(e,t,n){var r=t+this.config.thickness,i=n+this.config.thickness,o=e.getID();(0,l.forfor)(n,i,t,r,this.occupyPixel.bind(this),o),this.Render_drawSquare(t,n,e.getColor())}},{key:"flicker",value:function(e){var t=this,n=function(){clearInterval(u);var n=t.edgeOfSquare(e.x),r=t.edgeOfSquare(e.y);t.Render_drawSquare(n,r,e.getColor())},r=this,i=this.edgeOfSquare(e.x),o=this.edgeOfSquare(e.y),a=e.getColor(),s=!1,u=setInterval(function(){s?t.Render_clearSquare(i,o):t.Render_drawSquare(i,o,a),s=!s},1e3/this.config.flickerFrequency);setTimeout(n,r.config.flickerDuration)}},{key:"spawn",value:function(e,t,n){(0,l.log)(e+" spawning at ("+(0,l.round)(t.x,2)+", "+(0,l.round)(t.y,2)+")."),e.x=t.x,e.y=t.y,e.direction=n;var r=this.edgeOfSquare(e.x),i=this.edgeOfSquare(e.y);e.beAt(r,i),this.occupy(e,r,i),this.flicker(e)}},{key:"spawnAndStartPlayers",value:function(){var e=this;(0,l.log)("Spawnkill prevention is "+(this.preventSpawnkill?"enabled. No two players will spawn within "+e.safeMinimumSpawnDistance()+" Kuxels of each other.":"disabled. Players may spawn arbitrarily close to each other.")),function t(n){if(n<e.players.length){var r=e.preventSpawnkill?e.safeSpawnPosition():e.randomSpawnPosition();e.spawn(e.players[n],r,e.randomSpawnAngle()),setTimeout(function(){return t(++n)},e.config.flickerDuration)}else e.startPlayers()}(0)}},{key:"drawPlayer",value:function(e){for(this.config.thickness;e.isAlive()&&!e.queuedDraws.isEmpty();){var t=(e.getColor(),e.getLastPosition()),n=e.queuedDraws.dequeue(),r=this.edgeOfSquare(n.x),i=this.edgeOfSquare(n.y);if(!e.justWasAt(r,i)){e.getLastPosition().left,e.getLastPosition().top;this.isOnField(r,i)?this.isCrashing(e,r,i)?(this.death(e,"crashed"),this.occupy(e,t.left,t.top)):(e.beAt(r,i),e.isHoly()||this.occupy(e,r,i)):(this.death(e,"crashed into the wall"),this.occupy(e,t.left,t.top))}}}},{key:"drawHead",value:function(e){if(e.isAlive()){var t=e.getLastPosition(),n=t.left,r=t.top,i=e.getColor();this.Render_drawHead(n,r,i)}}},{key:"updateGUIScoreboard",value:function(){var e=this,t=function(t){var n=t.getID();e.GUI_updateScoreOfPlayer(n,e.getScoreOfPlayer(n))};this.getLivePlayers().forEach(t)}},{key:"death",value:function(e,t){if(e.die(t),this.getCurrentRound().add(e),this.updateGUIScoreboard(),this.isRoundOver()){if(this.isCompetitive()){var n=this.constructor.isAlive,r=this.players.find(n);this.winRound(r)}this.endRound()}}},{key:"winRound",value:function(e){(0,l.log)(e+" won the round."),this.occupy(e,this.edgeOfSquare(e.x),this.edgeOfSquare(e.y)),this.getCurrentRound().add(e)}},{key:"proceedKeyPressed",value:function(){this.hideProceedHint(),this.hideQuitHint(),this.isGameOver()?this.konecHry():this.isPostRound()&&this.beginNewRound()}},{key:"shouldShowReloadConfirmationOnReloadKey",value:function(){return this.isPostRound()}},{key:"shouldQuitOnQuitKey",value:function(){return this.isPostRound()&&!this.isGameOver()}},{key:"shouldQuitOnProceedKey",value:function(){return this.isEnded()}},{key:"GUI_playerReady",value:function(e){this.guiController.playerReady(e)}},{key:"GUI_playerUnready",value:function(e){this.guiController.playerUnready(e)}},{key:"GUI_updateScoreOfPlayer",value:function(e,t){this.guiController.updateScoreOfPlayer(e,t)}},{key:"GUI_gameStarted",value:function(){this.guiController.gameStarted()}},{key:"GUI_konecHry",value:function(){this.guiController.konecHry()}},{key:"GUI_showMessage",value:function(e){this.guiController.showMessage(e)}},{key:"GUI_hideMessage",value:function(e){this.guiController.hideMessage(e)}},{key:"Render_drawSquare",value:function(e,t,n){this.renderer.drawSquare(e,t,this.config.thickness,n)}},{key:"Render_drawHead",value:function(e,t,n){this.renderer.drawSquare_overlay(e,t,this.config.thickness,n)}},{key:"Render_clearSquare",value:function(e,t){this.renderer.clearSquare(e,t,this.config.thickness)}},{key:"Render_clearHeads",value:function(){this.renderer.clearRectangle_overlay(0,0,this.width,this.height)}},{key:"Render_clearField",value:function(){this.renderer.clearRectangle(0,0,this.width,this.height),this.renderer.clearRectangle_overlay(0,0,this.width,this.height)}},{key:"updatePlayer",value:function(e,t){if(e.isAlive()){var n=this.computeAngleChange(),r=e.getDirection();e.isPressingLeft()&&(r+=n),e.isPressingRight()&&(r-=n),e.setDirection((0,l.normalizeAngle)(r));var i=e.getVelocity()*t/1e3;e.x+=i*Math.cos(e.direction),e.y-=i*Math.sin(e.direction)}}},{key:"update",value:function(e){var t=this;this.players.forEach(function(n){t.updatePlayer(n,e)}),this.totalNumberOfTicks%this.maxTicksBetweenDraws()==0&&this.getLivePlayers().forEach(function(e){e.enqueueDraw()}),this.totalNumberOfTicks++}},{key:"draw",value:function(){this.Render_clearHeads(),this.players.forEach(this.drawPlayer,this),this.players.forEach(this.drawHead,this)}},{key:"end",value:function(e,t){if(t){var n=Math.round(a.default.resetFrameDelta());console.warn("Main loop panicked. Discarding "+n+"ms.")}}},{key:"initMainLoop",value:function(){this.MainLoop=a.default,this.MainLoop.setUpdate(this.update.bind(this)).setDraw(this.draw.bind(this)).setEnd(this.end.bind(this)).setSimulationTimestep(1e3/this.config.tickrate).setMaxAllowedFPS(this.config.maxFramerate)}}],[{key:"isRenderer",value:function(e){return void 0!==e}},{key:"isGUIController",value:function(e){return void 0!==e}},{key:"isAlive",value:function(e){return e.isAlive()}},{key:"calculateTargetScore",value:function(e){return 10*(e-1)}}]),e}()},function(e,t,n){"use strict";function r(e,t){function n(e,t,n,r,i,o){e.fillStyle=o,e.fillRect(t,n,r,i)}function r(e,t,n,r,i){e.clearRect(t,n,r,i)}function i(e,t,n){e.width=t,e.height=n}function o(n,r){i(e,n,r),i(t,n,r)}function a(e,t,r,i){n(d,e,t,r,r,i)}function s(e,t,n){r(d,e,t,n,n)}function u(e,t,n,i){r(d,e,t,n,i)}function l(e,t,r,i){n(h,e,t,r,r,i)}function c(e,t,n){r(h,e,t,n,n)}function f(e,t,n,i){r(h,e,t,n,i)}var d=e.getContext("2d"),h=t.getContext("2d");return{drawSquare:a,clearSquare:s,clearRectangle:u,drawSquare_overlay:l,clearSquare_overlay:c,clearRectangle_overlay:f,setSize:o}}Object.defineProperty(t,"__esModule",{value:!0}),t.Renderer=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.InfoMessage=void 0;var a=n(8);t.InfoMessage=function(e){function t(e){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"info"))}return o(t,e),t}(a.Message)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WarningMessage=void 0;var a=n(8);t.WarningMessage=function(e){function t(e){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"warning"))}return o(t,e),t}(a.Message)},function(e,t,n){"use strict";function r(e){function t(e,t){if(!(0,i.isString)(e.key))throw new TypeError("'The preference at index "+t+" does not have a valid key (found "+e.key+").");if(!(void 0!==e.type&&e.type.prototype instanceof o.Preference))throw new TypeError("Preference '"+e.key+"' does not use a valid preference type (found "+e.type+").");if(void 0===e.default)throw new TypeError("Preference '"+e.key+"' has no default value.");return new e.type(e)}function n(e){return void 0!==r(e)}function r(e){return w.find(function(t){return t.key===e})}function s(e){return k.find(function(t){return t.preference.key===e})}function u(){return w.map(function(e){return new a.PreferenceWithValue(e,g(e.key))})}function l(){return w.map(function(e){return new a.PreferenceWithValue(e,v(e.key))})}function c(){return w.map(function(e){return new a.PreferenceWithValue(e,e.getDefaultValue())})}function f(e){return e.key}function d(e,t){return r(e).isValidValue(t)}function h(e){_(e,y(e))}function y(e){if(!n(e))throw new Error("Preference '"+e+"' does not exist.");return r(e).getDefaultValue()}function p(e){return b+e}function _(e,t){if(!n(e))throw new Error("There is no preference with key '"+e+"'.");var o=r(e);if(d(e,t)){(0,i.log)("Setting preference '"+e+"' to '"+t+"'."),s(e).value=t;try{localStorage.setItem(p(e),o.constructor.stringify(t))}catch(t){throw(0,i.logError)("Failed to save value for preference '"+e+"' to localStorage. The following error was thrown:\n"+t),t}}else o.invalidValue(t)}function g(e){if(!n(e))throw new Error("There is no preference with key '"+e+"'.");var t=r(e),o=void 0;try{o=localStorage.getItem(p(e))}catch(t){throw(0,i.logError)("Failed to load saved value for preference '"+e+"' from localStorage. The following error was thrown:\n"+t),t}if(null===o)return null;if(d(e,t.constructor.parse(o)))return t.constructor.parse(o);throw new TypeError("'"+o+"' could not be parsed to a valid value for preference '"+t+"'.")}function v(e){if(!n(e))throw new Error("There is no preference with key '"+e+"'.");return s(e).value}function m(){(0,i.log)("Resetting all preferences ..."),w.map(f).forEach(h),(0,i.log)("Done.")}var b="pref_key_";(0,i.log)("Validating preferences ...");var w=function(e){return e.map(t)}(e);(0,i.log)("Done.");var k=c();return k.forEach(function(e){var t=e.preference.key,n=e.preference.getDefaultValue();try{var r=g(t);null===r&&(0,i.log)("Using default value '"+n+"' for preference '"+t+"' since there was no saved value."),e.value=null!==r?r:n}catch(e){e instanceof TypeError?(0,i.logWarning)("Using default value '"+n+"' for preference '"+t+"' since the saved value in localStorage was not a valid one."):(0,i.logWarning)("Using default value '"+n+"' for preference '"+t+"' since no saved value could be loaded from localStorage.")}}),{isValidPreferenceValue:d,set:_,getSaved:g,getCached:v,setToDefaultValue:h,getDefaultValue:y,getAllPreferencesWithValues_saved:u,getAllPreferencesWithValues_cached:l,getAllPreferencesWithDefaultValues:c,setAllToDefault:m}}Object.defineProperty(t,"__esModule",{value:!0}),t.PreferenceManager=r;var i=n(4),o=n(3),a=n(26)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(9),o=n(10),a=n(1),s=r(a),u=n(2),l=r(u);t.default=Object.freeze([{type:i.BooleanPreference,key:l.default.pref_key_prevent_spawnkill,label:s.default.pref_label_prevent_spawnkill,description:s.default.pref_label_description_prevent_spawnkill,default:!1},{type:i.BooleanPreference,key:l.default.pref_key_confirm_quit,label:s.default.pref_label_confirm_quit,description:s.default.pref_label_description_confirm_quit,default:!0},{type:o.MultichoicePreference,key:l.default.pref_key_scaling,label:s.default.pref_label_scaling,description:s.default.pref_label_description_scaling,options:[{key:l.default.pref_value_scaling_prefer_quality,label:s.default.pref_label_scaling_prefer_quality},{key:l.default.pref_value_scaling_prefer_size,label:s.default.pref_label_scaling_prefer_size}],default:l.default.pref_value_scaling_prefer_quality},{type:o.MultichoicePreference,key:l.default.pref_key_cursor,label:s.default.pref_label_cursor,description:s.default.pref_label_description_cursor,options:[{key:l.default.pref_value_cursor_always_visible,label:s.default.pref_label_cursor_always_visible},{key:l.default.pref_value_cursor_hidden_when_mouse_used_by_player,label:s.default.pref_label_cursor_hidden_when_mouse_used_by_player},{key:l.default.pref_value_cursor_always_hidden,label:s.default.pref_label_cursor_always_hidden}],default:l.default.pref_value_cursor_hidden_when_mouse_used_by_player},{type:o.MultichoicePreference,key:l.default.pref_key_edge_fix,label:s.default.pref_label_edge_fix,description:s.default.pref_label_description_edge_fix,options:[{key:l.default.pref_value_edge_fix_off,label:s.default.pref_label_edge_fix_off},{key:l.default.pref_value_edge_fix_minimal,label:s.default.pref_label_edge_fix_minimal},{key:l.default.pref_value_edge_fix_full,label:s.default.pref_label_edge_fix_full}],default:l.default.pref_value_edge_fix_off},{type:o.MultichoicePreference,key:l.default.pref_key_hints,label:s.default.pref_label_hints,description:s.default.pref_label_description_hints,options:[{key:l.default.pref_value_hints_all,label:s.default.pref_label_hints_all},{key:l.default.pref_value_hints_warnings_only,label:s.default.pref_label_hints_warnings_only},{key:l.default.pref_value_hints_none,label:s.default.pref_label_hints_none}],default:l.default.pref_value_hints_all}])},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var i=n(0),o=n(13),a=n(5),s=n(14),u=n(12),l=n(18),c=r(l),f=n(17),d=n(15),h=n(16),y=n(6),p=n(1),_=r(p),g=n(2),v=r(g);!function(){function e(e){return ce.keys.proceed.includes(e)}function t(e){return ce.keys.quit.includes(e)}function n(e){return!le.includes(e)}function r(e){if(he.isStarted())throw new Error("Cannot change edge padding when the game is running.");var t=re-e,n=ie-2*e;he.setSize(t,n),de.setEdgePadding(e)}function l(e){var t=0;"minimal"===e?t=1:"full"===e&&(t=oe);try{r(t)}catch(e){(0,i.logError)(e)}}function p(e){de.setBlurryScaling(e===v.default.pref_value_scaling_prefer_size)}function g(){return{minHoleSize:ce.minHoleSize,maxHoleSize:ce.maxHoleSize,minHoleInterval:ce.minHoleInterval,maxHoleInterval:ce.maxHoleInterval}}function m(){var e=ce.thickness,t=g(),n={};return n.minPaddedHoleSize=t.minHoleSize+e,n.maxPaddedHoleSize=t.maxHoleSize+e,n.minPaddedHoleInterval=Math.max(0,t.minHoleInterval-e),n.maxPaddedHoleInterval=Math.max(0,t.maxHoleInterval-e),n}function b(e){return ce.defaultPlayers.find(function(t){return t.id===e})}function w(e){var t=b(e);if(void 0===t)throw new TypeError("There is no default player with ID "+e+".");return new a.Player(t.id,t.name,t.color,t.keyL,t.keyR,m())}function k(){var e=he.getPlayers().some(E),t=void 0;switch(fe.getCached(v.default.pref_key_cursor)){case v.default.pref_value_cursor_hidden_when_mouse_used_by_player:t=e?v.default.cursor_hidden:v.default.cursor_visible;break;case v.default.pref_value_cursor_always_hidden:t=v.default.cursor_hidden;break;default:t=v.default.cursor_visible}(0,i.log)("Setting cursor behavior to "+t+"."),de.setCursorBehavior(t)}function P(){var e=he.getNumberOfPlayers();e>0&&(X(),k(),he.setMode(1===e?o.Game.PRACTICE:o.Game.COMPETITIVE),he.start())}function E(e){return e.usesAnyMouseButton()}function S(){he.getPlayers().some(function(e){return e.hasKey(i.KEY.CTRL)})?de.showMessage(ce.messages.ctrl):de.hideMessage(ce.messages.ctrl),he.getPlayers().some(function(e){return e.hasKey(i.KEY.ALT)})?de.showMessage(ce.messages.alt):de.hideMessage(ce.messages.alt),he.getPlayers().some(E)?de.showMessage(ce.messages.mouse):de.hideMessage(ce.messages.mouse)}function O(e){he.addPlayer(w(e)),S(),clearTimeout(pe),de.hideMessage(ce.messages.pick),clearTimeout(ye),ye=setTimeout(function(){de.showMessage(ce.messages.proceed)},ce.hintDelay)}function M(e){he.removePlayer(e),S(),clearTimeout(ye),0===he.getNumberOfPlayers()?de.hideMessage(ce.messages.proceed):ye=setTimeout(function(){de.showMessage(ce.messages.proceed)},ce.hintDelay)}function T(e,t){return t===e.keyL||e.keyL instanceof Array&&e.keyL.includes(t)}function C(e,t){return t===e.keyR||e.keyR instanceof Array&&e.keyR.includes(t)}function x(e,t){T(e,t)?O(e.id):C(e,t)&&M(e.id)}function A(e){e.stopPropagation(),e.preventDefault()}function I(e){ce.defaultPlayers.forEach(function(t){x(t,e)})}function D(e){ce.defaultPlayers.forEach(function(t){x(t,i.MOUSE.pack(e))})}function L(e){var t=he.isStarted()?K:de.isShowingSettings()?V:F;de.keyPressed(e,t)}function R(e){var t=he.isStarted()?N:de.isShowingSettings()?G:j;de.mouseClicked(e,t)}function H(e){he.isStarted()&&W()}function F(t){n(t.keyCode)&&t.preventDefault();var r=t.keyCode;r===ae?U():e(r)?P():I(r)}function j(e){e.preventDefault(),D(e.button)}function U(){window.location.reload()}function q(){he.quit(),de.gameQuit(),he=ee(),B()}function K(r){n(r.keyCode)&&r.preventDefault();var i=r.keyCode;e(i)?he.isPaused()?he.resume():he.shouldQuitOnProceedKey()?q():he.proceedKeyPressed():t(i)&&he.shouldQuitOnQuitKey()?!0!==fe.getCached(v.default.pref_key_confirm_quit)||de.isShowingDialog()?q():de.showDialog(ce.dialogs.confirmation_quit):i===ae&&(!0===fe.getCached(v.default.pref_key_confirm_quit)?he.shouldShowReloadConfirmationOnReloadKey()&&!de.isShowingDialog()&&de.showDialog(ce.dialogs.confirmation_reload,U):U())}function N(e){e.preventDefault()}function W(e){var t=_.default.hint_unload;return e.returnValue=t,t}function V(e){var n=e.keyCode;t(n)?z():n===ae&&U()}function G(e){}function Y(){clearTimeout(pe),clearTimeout(ye);try{de.updateSettingsForm(fe.getAllPreferencesWithValues_saved())}catch(e){(0,i.logWarning)("Could not load settings from localStorage. Using cached settings instead."),de.updateSettingsForm(fe.getAllPreferencesWithValues_cached()),Q(e)}de.showSettings()}function z(){de.parseSettingsForm().forEach(function(e){try{fe.set(e.key,e.value)}catch(t){(0,i.logWarning)("Could not save setting '"+e.key+"' to localStorage."),Q(t)}}),B(),de.hideSettings()}function B(){var e=void 0,t=void 0,n=void 0,r=void 0;try{e=fe.getSaved(v.default.pref_key_edge_fix),t=fe.getSaved(v.default.pref_key_hints),n=fe.getSaved(v.default.pref_key_prevent_spawnkill),r=fe.getSaved(v.default.pref_key_scaling)}catch(o){(0,i.logWarning)("Could not load settings from localStorage. Using cached settings instead."),e=fe.getCached(v.default.pref_key_edge_fix),t=fe.getCached(v.default.pref_key_hints),n=fe.getCached(v.default.pref_key_prevent_spawnkill),r=fe.getCached(v.default.pref_key_scaling),Q(o)}l(e),de.setMessageMode(t),he.setPreventSpawnkill(n),p(r)}function Q(e){e.name===v.default.error_name_security?de.showMessage(ce.messages.preferences_access_denied):de.showMessage(ce.messages.preferences_localstorage_failed)}function X(){clearTimeout(pe),clearTimeout(ye),de.clearMessages()}function Z(){(0,i.logWarning)("Application lost focus."),he.isLive()&&he.pause(),i.Keyboard.reset(),i.Mouse.reset()}function J(){var e=(0,i.byID)(v.default.id_button_show_settings);e instanceof HTMLElement&&(e.addEventListener("mousedown",A),e.addEventListener("click",Y))}function $(){var e=(0,i.byID)(v.default.id_button_hide_settings);e instanceof HTMLElement&&(e.addEventListener("mousedown",A),e.addEventListener("click",z))}function ee(){return new o.Game(ce,(0,s.Renderer)(te,ne),de)}var te=(0,i.byID)("canvas_main"),ne=(0,i.byID)("canvas_overlay"),re=te.width,ie=te.height,oe=4,ae=i.KEY.F5,se=i.KEY.F11,ue=i.KEY.F12,le=[se,ue],ce=Object.freeze({tickrate:600,maxFramerate:300,canvas:te,thickness:3,speed:60,turningRadius:28.5,minSpawnAngle:-Math.PI/2,maxSpawnAngle:Math.PI/2,spawnMargin:100,preventSpawnkill:!1,flickerFrequency:20,flickerDuration:830,minHoleInterval:90,maxHoleInterval:300,minHoleSize:5,maxHoleSize:9,hintDelay:3e3,keys:{proceed:[i.KEY.SPACE,i.KEY.ENTER],quit:[i.KEY.ESCAPE]},messages:Object.freeze({pick:new d.InfoMessage(_.default.hint_pick),proceed:new d.InfoMessage(_.default.hint_proceed),next:new d.InfoMessage(_.default.hint_next),quit:new d.InfoMessage(_.default.hint_quit),alt:new h.WarningMessage(_.default.hint_alt),ctrl:new h.WarningMessage(_.default.hint_ctrl),mouse:new h.WarningMessage(_.default.hint_mouse),preferences_access_denied:new h.WarningMessage(_.default.hint_preferences_access_denied),preferences_localstorage_failed:new h.WarningMessage(_.default.hint_preferences_localstorage_failed)}),dialogs:Object.freeze({confirmation_quit:new y.ConfirmationDialog(_.default.label_text_confirm_quit,q),confirmation_reload:new y.ConfirmationDialog(_.default.label_text_confirm_reload,U)}),defaultPlayers:Object.freeze([{id:1,name:"Red",color:"#FF2800",keyL:i.KEY[1],keyR:i.KEY.Q},{id:2,name:"Yellow",color:"#C3C300",keyL:[i.KEY.CTRL,i.KEY.Z],keyR:[i.KEY.ALT,i.KEY.X]},{id:3,name:"Orange",color:"#FF7900",keyL:i.KEY.M,keyR:i.KEY.COMMA},{id:4,name:"Green",color:"#00CB00",keyL:i.KEY.LEFT_ARROW,keyR:i.KEY.DOWN_ARROW},{id:5,name:"Pink",color:"#DF51B6",keyL:[i.KEY.DIVIDE,i.KEY.END,i.KEY.PAGE_DOWN],keyR:[i.KEY.MULTIPLY,i.KEY.PAGE_UP]},{id:6,name:"Blue",color:"#00A2CB",keyL:i.MOUSE.LEFT,keyR:i.MOUSE.RIGHT}])}),fe=new f.PreferenceManager(c.default);!function(){(0,i.log)("Adding event listeners ..."),J(),$(),document.addEventListener("keydown",L),document.addEventListener("mousedown",R),document.addEventListener("contextmenu",A),window.addEventListener("beforeunload",H),window.addEventListener("blur",Z),document.addEventListener("keydown",i.Keyboard.onKeydown.bind(i.Keyboard)),document.addEventListener("keyup",i.Keyboard.onKeyup.bind(i.Keyboard)),document.addEventListener("mousedown",i.Mouse.onMousedown.bind(i.Mouse)),document.addEventListener("mouseup",i.Mouse.onMouseup.bind(i.Mouse)),(0,i.log)("Done.")}();var de=(0,u.GUIController)(ce),he=ee(),ye=void 0,pe=setTimeout(function(){de.showMessage(ce.messages.pick)},ce.hintDelay);B()}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.Round=function(){function e(t){r(this,e),this.results=[]}return i(e,[{key:"add",value:function(e){this.results.push(e)}},{key:"getSuccessOfPlayer",value:function(e){for(var t=0;t<this.results.length;t++)if(this.results[t].hasID(e))return t;return this.results.length}},{key:"getResults",value:function(){return this.results}}]),e}()},,function(e,t,n){"use strict";function r(){var e=[],t=0;this.getLength=function(){return e.length-t},this.hasItem=function(t){return-1!==e.indexOf(t)},this.isEmpty=function(){return 0===e.length},this.enqueue=function(t){e.push(t)},this.dequeue=function(){if(0!==e.length){var n=e[t];return 2*++t>=e.length&&(e=e.slice(t),t=0),n}},this.peek=function(){return 0<e.length?e[t]:void 0}}Object.defineProperty(t,"__esModule",{value:!0}),t.Queue=r},function(e,t,n){"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0});"function"==typeof Symbol&&Symbol.iterator;/**
 * mainloop.js 1.0.1-20150816
 *
 * @author Isaac Sukin (http://www.isaacsukin.com/)
 * @license MIT
 */
t.default=!function(o){function a(e){if(c+p>e)return void(s=m(a));for(l+=e-c,c=e,k(e,l),e>d+1e3&&(f=.25*h+.75*f,d=e,h=0),h++,y=0;l>=u;)if(P(u),l-=u,++y>=240){v=!0;break}E(l/u),S(f,v),v=!1,s=m(a)}var s,u=1e3/60,l=0,c=0,f=60,d=0,h=0,y=0,p=0,_=!1,g=!1,v=!1,m=o.requestAnimationFrame||function(){var e,t,n=Date.now();return function(r){return e=Date.now(),t=Math.max(0,u-(e-n)),n=e+t,setTimeout(function(){r(e+t)},t)}}(),b=o.cancelAnimationFrame||clearTimeout,w=function(){},k=w,P=w,E=w,S=w;o.MainLoop={getSimulationTimestep:function(){return u},setSimulationTimestep:function(e){return u=e,this},getFPS:function(){return f},getMaxAllowedFPS:function(){return 1e3/p},setMaxAllowedFPS:function(e){return void 0===e&&(e=1/0),0===e?this.stop():p=1e3/e,this},resetFrameDelta:function(){var e=l;return l=0,e},setBegin:function(e){return k=e||k,this},setUpdate:function(e){return P=e||P,this},setDraw:function(e){return E=e||E,this},setEnd:function(e){return S=e||S,this},start:function(){return g||(g=!0,s=m(function(e){E(1),_=!0,c=e,d=e,h=0,s=m(a)})),this},stop:function(){return _=!1,g=!1,b(s),this},isRunning:function(){return _}},r=o.MainLoop,void 0!==(i="function"==typeof r?r.call(t,n,t,e):r)&&(e.exports=i)}(window)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.IntegerRangePreference=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=(n(3),n(11)),l=n(4);t.IntegerRangePreference=function(e){function t(e){if(r(this,t),!(0,l.isInt)(e.min)||!(0,l.isInt)(e.max))throw new TypeError("min and max must be integers (found "+e.min+" and "+e.max+" for preference '"+e.key+"').");var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.min=e.min,n.max=e.max,n.isValidValue(e.default)||s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"invalidValue",n).call(n,e.default),n}return o(t,e),a(t,[{key:"isValidValue",value:function(e){return(0,l.isInt)(e)&&e>=this.min&&e<=this.max}}],[{key:"stringify",value:function(e){return e.toString()}},{key:"parse",value:function(e){return parseInt(e)}}]),t}(u.RangePreference)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.MultichoicePreferenceOption=void 0;var i=n(4);t.MultichoicePreferenceOption=function e(t,n){r(this,e);if(!function(e){return(0,i.isNonEmptyString)(e)}(t))throw new TypeError("The key of a MultichoicePreference option must be a non-empty string (found "+t+").");if(!function(e){return(0,i.isString)(e)}(n))throw new TypeError("The label of a MultichoicePreference option must be a string (found "+n+" for option '"+t+"').");this.key=t,this.label=n}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});t.PreferenceWithValue=function e(t,n){if(r(this,e),!t.isValidValue(n))throw new TypeError(n+" is not a valid value for preference "+t.key+".");this.preference=t,this.value=n}}]);
//# sourceMappingURL=zatacka.min.js.map